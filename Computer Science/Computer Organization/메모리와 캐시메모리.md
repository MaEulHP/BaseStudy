# 메모리와 캐시메모리
## RAM의 특징과 종류
### RAM의 특징
- 휘발성 저장 장치: 전원을 끄면 저장된 내용이 전부 사라짐
    - RAM 등
- 비휘발성 저장 장치: 전원이 꺼져도 저장된 내용이 유지
    - SSD, CD-ROM 등
- 프로그램 실행 방법
    - CPU는 보조 기억 장치에 접근할 수 없음
    - 주 기억 장치에 실행할 대상 저장
    - 주 기억 장치에 없다면, 보조 기억 장치에서 복사해옴
### RAM의 용량과 성능
- RAM 용량이 작을 수록 보조 기억 장치에 접근을 자주 -> 속도가 느려짐 -> 성능 저하의 주 원인
- RAM 용량이 클수록 보조 기억 장치에서 가져올 대상을 한번에 복사 -> 성능 향상
- RAM 용량이 무한히 크다고 해서 속도가 무한히 빨라지지 않음
    - 책을 100권 미리 가져놓는다고 해서 책을 빨리 읽는 게 아닌 것과 동일
### RAM의 종류
- DRAM: Dynamic RAM
    - 시간이 지날수록 저장된 데이터가 점차 사라짐
    - 데이터 소멸을 막기 위해 일정 주기로 데이터를 재활성화(다시 저장)해야 함
    - 주로 많이 사용: 소비 전력이 낮고, 저렴하며 집적도가 높음
- SRAM: Static RAM
    - 시간이 지나도 저장된 데이터가 사라지지 않음
    - 일반적으로 DRAM보다 속도가 빠름
    - 집적도가 낮고, 소비 전력이 높으며 가격이 비쌈
    - 주 기억 장치가 아닌 캐시메모리에서 사용
- SDRAM: Synchronous Dynamic RAM
    - 클럭 신호와 동기화된 형태의 DRAM
    - 클럭 타이밍에 맞춰 CPU와 정보를 교환
- DDR SDRAM: Double Data SDRAM
    - 대역폭을 넓혀 속도를 빠르게 만든 SDRAM
    - DDR2(2배), DDR3(8배) 등 대역폭의 크기에 따라 숫자가 바뀜
## 메모리의 주소 공간
- 주소의 두 가지 종류
    - 물리 주소: 메모리 하드웨어가 사용하는 주소
    - 논리 주소: CPU가 실행 중인 프로그램이 사용하는 주소
### 물리 주소와 논리 주소
- 프로그램은 메모리에 무엇이 어디에 저장되어 있는지 다 알지 못함
    - 메모리의 저장된 정보가 시시각각 변하기 때문
- 물리 주소: 정보가 실제로 저장된 하드웨어상의 주소를 의미
- 논리 주소: 실행중인 프로그램 각각에게 부여된 0번지부터 시작되는 주소

- 프로그램은 다른 프로그램의 물리 주소를 알 필요 없음
    - 언제든지 프로그램이 사라지고 새로운 프로그램이 적재될 수 있기 때문
- 모든 프로그램은 자신만을 위한 0번지부터 시작하는 논리 주소
- CPU가 메모리와 상호작용을 어떻게 하나
    - 물리 주소와 논리 주소 간의 변환
    - 변환이 없다면 서로 이해할 수 없는 주소 체계
- 메모리 관리 장치(Memory Management Unit; MMU)
    - 논리 주소와 물리 주소 간의 변환
    - CPU와 주소 버스 사이에 위치
    - CPU가 발생시킨 논리 주소 + 베이스 레지스터 값
    - 베이스 레지스터: 프로그램의 가장 작은 물리 주소 값을 저장
    - 논리 주소: 베이스 레지스터 값으로부터 떨어진 거리
### 메모리 보호 기법
- 프로그램의 논리 주소 범위를 벗어난 명령
    - 주소 범위 밖의 주소에 접근, 데이터 저장 또는 삭제, 변경하라는 명령
    - 실행되어서는 안됨: 다른 프로그램을 망가뜨리는 행위
- 한계 레지스터: 논리 주소의 최대 크기를 저장
    - 논리 주소 범위를 벗어나는 명령어 실행을 방지
    - 실행 중인 프로그램이 다른 프로그램에 영향을 받지 않도록 보호
    - 메모리 접근하기 전에 접근하고자 하는 주소가 한계 레지스터보다 작은가를 검사
## 캐시 메모리
- CPU가 메모리에 접근하는 시간을 해결하기 위한 저장 장치
### 저장 장치 계층 구조
- 저장 장치의 일반적인 명제
    1. CPU와 가까운 저장 장치는 빠르고, 멀리 있는 저장 장치는 느리다
    2. 속도가 빠른 저장 장치는 저장 용량이 작고, 가격이 비싸다
- 저장 장치 계층 구조: CPU에 얼마나 가까운가를 기준으로 계층적 표현
    - 레지스터 -> 메모리 -> 보조 기억 장치
### 캐시 메모리
- CPU의 연산 속도 발전을 메모리 접근 속도가 따라가지 못함
- 캐시 메모리  
    - CPU와 메모리 사이에 위치
    - 레지스터보다 용량이 큼
    - 메모리보다 빠름
    - SRAM 기반 저장 장치
### 참조 지역성 원리
- 캐시 메모리는 CPU가 사용할 대상을 예측해서 저장
    - 데이터가 실제로 사용됨: 캐시 히트
    - 예측이 틀려 메모리에 접근: 캐시 미스
- 캐시 메모리에 가져올 데이터를 결정하는 원칙: 참조 지역성의 원리(Locality of reference)
    - CPU는 최근에 접근했던 메모리 공간에 다시 접근(spatial)
        - 일반적으로 한번 사용한 변수 값 같은 것들은 프로그램이 실행되는 동안 여러번 접근
    - CPU는 접근한 메모리 공간 근처를 접근(temporal)
        - 한 가지 프로그램을 실행할 때, 그 프로그램 주소 범위를 집중적으로 접근