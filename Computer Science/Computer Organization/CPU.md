# CPU
## ALU
- 계산(연산)을 수행하는 부품 
- 레지스터를 통해 피연산자 받음
- 제어장치로부터 제어 신호를 통해 수행할 연산을 결정\
- 두 가지 정보로 산술연산, 논리연산 등 다양한 연산을 수행
- 연산 결과는 바로 메모리에 저장 X: 레지스터에 임시 저장
    - 레지스터 접근 시간 < 메모리 접근 시간
    - 메모리에 자주 접근하면 CPU가 느려짐
### 플래그
- 연산 결과에 대한 추가적인 상태 정보
    - 예: 결과값이 너무 크다
- 대표적인 6가지
    - 부호 플래그: 연산한 결과의 부호
    - 제로 플래그: 연산 결과가 0인지
    - 캐리 플래그: 연산 결과 올림수나 빌림수가 발생했는지
    - 오버플로우 플래그: 오버플로우가 발생했는지
    - 인터럽트 플래그: 인터럽트가 가능한지
    - 슈퍼바이저 플래그: 커널모드로 실행중인지, 사용자모드로 실행중인지
- 플래그들은 플래그 레지스터에 저장됨

## 제어장치
- 제어 신호를 내보내고, 명령어를 해석하는 장치
- 제어 신호: 컴퓨터 부품을 관리하고 작동시키기 위한 전기 신호
1. 제어장치는 클럭신호를 받아들인다
    - 클럭: 컴퓨터의 시간 단위
    - 컴퓨터의 부품들은 클럭 신호에 맞춰 작동
2. 제어장치는 '해석해야 할 명령어'를 받아들임
    - 명령어 레지스터: CPU가 해석해야 할 명령어를 저장하는 레지스터
    - 제어 장치는 명령어 레지스터로부터 해석할 명령어를 받아들임
    - 제어 신호를 발생시켜 수행해야 할 내용을 알림
3. 제어장치는 플래그 레지스터 속 플래그 값을 받아들임
    - 말 그대로, 플래그 값을 참고하여 명령어 전달
4. 제어장치는 시스템 버스, 그 중 제어 버스로 전달된 제어 신호를 받아들임
    - 제어 신호는 CPU 뿐만 아니라 외부 다른 장치도 발생 가능
    - 외부로부터 전달된 제어 신호를 받아들이기도 함 
- 제어장치는 필요한 장치에 제어 신호를 전송, 작업을 수행 

## 레지스터
- 프로그램 속 명령어와 데이터는 실행 전후로 반드시 레지스터의 저장
- 레지스터에 저장된 값 관찰 -> 실행 흐름을 파악할 수 있음
### 반드시 알아야 할 8가지 레지스터
- 많은 CPU가 공통으로 포함하는 레지스터
1. 프로그램 카운터(PC)
    - 메모리에서 가져올 명령어의 주소를 저장
    - 명령어 포인터라고도 함
2. 명령어 레지스터
    - 해석할 명령어, 방금 메모리에서 읽어들인 명령어를 저장하는 레지스터
3. 메모리 주소 레지스터
    - 메모리 주소를 저장하는 레지스터
    - 주소 값을 주소 버스로 전달할 때 참조
4. 메모리 버퍼 레지스터
    - 메모리와 주고 받을 값을 저장하는 레지스터
    - 주소가 아닌 데이터와 명령어가 저장됨
5. 플래그 레지스터
    - 플래그 상태를 저장하는 레지스터
6. 범용 레지스터
    - 다양하고 일반적인 상황에 자유롭게 사용이 가능한 레지스터
7. 스택 포인터
8. 베이스 레지스터
### 스택 주소 지정 방식
- 스택과 스택 포인터를 이용한 주소 지정 방식
- 스택 포인터: 스택의 Top을 가리키는 레지스터
- 스택 영역을 이용해서 데이터를 저장하고 꺼내는 방식
### 변위 주소 지정 방식
- 오퍼랜드 필드의 값(변위)과 특정 레지스터 값을 더해 유효 주소를 얻어내는 방식
#### 상대 주소 지정 방식 
- 오퍼랜드와 프로그램 카운터 값을 더하여 유효 주소를 얻는 방식
- 분기하여 특정 주소의 코드를 실행할 때 사용
#### 베이스 레지스터 주소 지정 방식
- 오퍼랜드와 베이스 레지스터 값을 더하여 유효 주소를 얻는 방식
- 베이스 레지스터: 기준 주소를 저장
- 오퍼랜드: 기준 주소로부터 떨어진 거리를 저장
- 예: 기준 주소 200번지에서 50만큼 떨어진 250번지로 접근하라

## 명령어 사이클
- 하나의 명령어를 처리하는 정형화된 흐름
- 프로그램 속 명령어가 실행되는 일정한 주기
- 인출 사이클 -> (간접 사이클; 필요하다면) -> 실행 사이클
- 인출 사이클: 메모리에 있는 명령어를 CPU로 가지고 오는 단계
- 실행 사이클: 가져온 명령어를 실행하는 단계
- 간접 사이클: 추가적인 메모리 접근을 실행하는 단계

## 인터럽트
- CPU의 작업을 중단하는 신호
- 2가지: 동기 인터럽트, 비동기 인터럽트
### 동기 인터럽트
- CPU에 의해 발생하는 인터럽트
- 명령어 수행 중 예기치 못한 상황 (예외; Exception)
### 비동기 인터럽트
- 주로 입출력 장치에 의해 발생하는 인터럽트
- 알림 역할: 입출력이 발생, 이를 처리해라
- 하드웨어 인터럽트: 입출력 장치에 의해서 발생하는 인터럽트
#### 하드웨어 인터럽트
- 명령어의 효율적인 처리를 위해 필요
    - 입출력이 완료될 때까지, CPU는 다른 명령어 사이클을 수행
    - 인터럽트가 발생하면 수행중인 명령어를 중단하고 처리
    - 계속 입출력 장치를 확인할 필요가 없음
- 처리 순서
    1. 입출력 장치는 CPU에 인터럽트 요청 신호 전달
    2. CPU는 실행 사이클이 끝나고 명령어 인출 전 항상 인터럽트 여부 확인
    3. 인터럽트 요청을 확인, 인터럽트 플래그를 통해 인터럽트 수행 가능 여부 확인
    4. 인터럽트 수행 가능 -> 현재 작업 백업
    5. 인터럽트 벡터를 참조하여 인터럽트 서비스 루틴 실행
    6. 인터럽트 서비스 루틴 종료, 백업해둔 작업을 복구해 실행
- 인터럽트 플래그를 통해 인터럽트를 막을지 말지 결정
    - 막을 수 없는 인터럽트도 있음
- 인터럽트 서비스 루틴: 인터럽트를 처리하기 위한 프로그램
    - 인터럽트 핸들러라고도 함
    - 어떤 인터럽트가 발생했을 때, 어떻게 처리할 것인지에 대한 정보
- 인터럽트 벡터: 인터럽트 서비스 루틴을 식별하기 위한 정보